webpackJsonp([4],{"0t2d":function(e,a){},p0rv:function(e,a,r){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var t=r("woOf"),o=r.n(t),l=r("fZjL"),n=r.n(l),i=r("Xxa5"),s=r.n(i),d=r("exGp"),c=r.n(d),u=r("8e4C"),f=r("Cmve"),v={data:function(){return{type:+this.$route.query.type,defaultAddr:"",areaCode:{},area:"",loading:!1,form:{verifyLogo:"",focusAddrList:[],mobilePhone:"",defaultAddr:""},errors:{area:"",mobilePhone:"",focusAddrList:[],defaultAddr:"",villages:[]},areaList:f.a,areaSelectShow:!1,villages:[{village:""}]}},created:function(){this.getType(),this.getRecylerInfo()},methods:{getRecylerInfo:function(){var e=this;this.$ajax("getRecylerInfo").then(function(a){var r=a.data.defaultAddr||u.a,t=[],o=f.a.province_list[r.provinceId],l=f.a.city_list[r.cityId],n=f.a.county_list[r.areaId];t.push(o),o!==l&&t.push(l),t.push(n),e.area=t.join("/"),e.defaultAddr=r.addrDetail,e.form=a.data})},getType:function(){var e=this;this.$ajax("getUserType").then(function(a){var r=a.data.userType;e.type=r})},onRead:function(e){var a=this;return c()(s.a.mark(function r(){var t;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a.loading=!0,t={imgBase64:e.content,bizType:1},r.next=4,a.$ajax("upload",t).then(function(e){a.form.verifyLogo=e.data}).finally(function(){a.loading=!1});case 4:case"end":return r.stop()}},r,a)}))()},handleAreaSelect:function(e){var a=[],r=[];e.map(function(e){r.push(e.code),-1===a.indexOf(e.name)&&a.push(e.name)}),this.area=a.join("/"),this.areaCode={provinceId:r[0],cityId:r[1],areaId:r[2]},this.areaSelectShow=!1},handleAddOrRemoveVillage:function(e,a){if(0===a){if(this.villages.length>=3)return this.$dialog.alert({title:"提醒",message:"服务小区最多添加3个"}),!1;this.villages.push({village:""})}else this.villages.splice(a,1)},submit:function(){var e=this;return c()(s.a.mark(function a(){var r,t;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(e.form.focusAddrList=[],e.area?e.errors.area=null:e.errors.area="请填写",e.form.mobilePhone?e.errors.mobilePhone=null:e.errors.mobilePhone="请填写",e.form.mobilePhone&&(/^\d{11}$/.test(e.form.mobilePhone)?e.errors.mobilePhone=null:e.errors.mobilePhone="格式不正确"),e.defaultAddr?e.errors.defaultAddr=null:e.errors.defaultAddr="请填写",2===e.type&&(e.errors.villages.length=0,e.villages.map(function(a){a.village?a.errorMessage=null:a.errorMessage="请填写",e.errors.villages.push(a.errorMessage)})),r=[],n()(e.errors).map(function(a){var t=e.errors[a]&&e.errors[a].join("");t&&r.push(t)}),!r.length){a.next=10;break}return a.abrupt("return",!1);case 10:return e.form.defaultAddr=o()({},e.areaCode,{addrDetail:e.defaultAddr}),2===e.type&&e.villages.map(function(a){e.form.focusAddrList.push(o()({},e.areaCode,{addrDetail:a.village}))}),t={mobilePhone:e.form.mobilePhone,defaultAddr:e.form.defaultAddr},2===e.type&&(t.verifyLogo=e.form.verifyLogo,t.focusAddrList=e.form.focusAddrList),console.log(t),a.next=17,e.$ajax("addUserDetail",t);case 17:return a.next=19,e.$dialog.alert({message:"操作成功"});case 19:window.location.href="/";case 20:case"end":return a.stop()}},a,e)}))()}}},h={render:function(){var e=this,a=e.$createElement,r=e._self._c||a;return r("div",{attrs:{id:"register-recyler"}},[r("van-row",[r("van-col",{staticClass:"title",attrs:{span:"24"}},[e._v("请补充以下信息")])],1),e._v(" "),r("van-cell-group",{staticClass:"content"},[2===e.type?r("van-cell",{staticClass:"van-field van-cell photo",attrs:{title:"头像"}},[r("div",{staticStyle:{"text-align":"left"}},[e.form.verifyLogo?r("img",{attrs:{src:e.form.verifyLogo}}):e._e()]),e._v(" "),r("template",{slot:"right-icon"},[r("van-uploader",{attrs:{"after-read":e.onRead}},[r("van-icon",{attrs:{name:"photograph"}})],1)],1)],2):e._e(),e._v(" "),r("van-field",{attrs:{label:"所在地区",readonly:"",required:"",autosize:"",placeholder:"选择 省 / 市 / 区","error-message":e.errors.area},on:{focus:function(a){a.preventDefault(),e.areaSelectShow=!0}},model:{value:e.area,callback:function(a){e.area=a},expression:"area"}}),e._v(" "),1===e.type||2===e.type?r("van-field",{attrs:{label:"住址",required:"",placeholder:"请输入您的小区地址","error-message":e.errors.defaultAddr},model:{value:e.defaultAddr,callback:function(a){e.defaultAddr=a},expression:"defaultAddr"}}):e._e(),e._v(" "),e._l(e.villages,function(a,t){return 2===e.type?r("van-field",{key:t,attrs:{label:"服务小区",required:"",placeholder:"请输入小区详细地址","error-message":e.errors.villages[t]},on:{"click-icon":function(r){e.handleAddOrRemoveVillage(a,t)}},model:{value:a.village,callback:function(r){e.$set(a,"village",r)},expression:"item.village"}},[r("van-icon",0===t?{attrs:{slot:"icon",name:"add"},slot:"icon"}:{attrs:{slot:"icon",name:"delete"},slot:"icon"})],1):e._e()}),e._v(" "),r("van-field",{attrs:{label:"手机号",required:"",placeholder:"请输入手机号","error-message":e.errors.mobilePhone},model:{value:e.form.mobilePhone,callback:function(a){e.$set(e.form,"mobilePhone",a)},expression:"form.mobilePhone"}})],2),e._v(" "),r("van-row",[r("van-col",{attrs:{span:"24"}},[r("van-button",{attrs:{type:"primary",block:""},on:{click:e.submit}},[e._v("提交信息")])],1)],1),e._v(" "),r("van-popup",{attrs:{position:"bottom",overlay:!0},model:{value:e.areaSelectShow,callback:function(a){e.areaSelectShow=a},expression:"areaSelectShow"}},[r("van-area",{attrs:{"area-list":e.areaList},on:{confirm:e.handleAreaSelect,cancel:function(a){e.areaSelectShow=!1}}})],1),e._v(" "),e.loading?r("van-loading",{staticClass:"loading",attrs:{color:"white"}}):e._e()],1)},staticRenderFns:[]};var p=r("VU/8")(v,h,!1,function(e){r("0t2d")},"data-v-d030f960",null);a.default=p.exports}});
//# sourceMappingURL=4.cd7e26c5b498d565c164.js.map