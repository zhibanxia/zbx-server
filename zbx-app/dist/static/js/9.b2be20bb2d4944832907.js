webpackJsonp([9],{SAy0:function(e,r){},p0rv:function(e,r,a){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t=a("woOf"),o=a.n(t),l=a("fZjL"),n=a.n(l),i=a("Xxa5"),s=a.n(i),d=a("exGp"),c=a.n(d),u=a("8e4C"),f=a("Cmve"),v={data:function(){return{type:+this.$route.query.type,defaultAddr:"",areaCode:{},area:"",loading:!1,form:{verifyLogo:"",focusAddrList:[],mobilePhone:"",defaultAddr:""},errors:{area:"",mobilePhone:"",focusAddrList:[],defaultAddr:"",villages:[]},areaList:f.a,areaSelectShow:!1,villages:[{village:""}]}},created:function(){this.getType(),this.getRecylerInfo()},methods:{getRecylerInfo:function(){var e=this;this.$ajax("getRecylerInfo").then(function(r){var a=r.data.defaultAddr||u.a,t=[],o=f.a.province_list[a.provinceId],l=f.a.city_list[a.cityId],n=f.a.county_list[a.areaId];t.push(o),o!==l&&t.push(l),t.push(n),e.area=t.join("/"),e.defaultAddr=a.addrDetail,e.areaCode=a;var i=r.data,s=i.focusAddrList,d=i.mobilePhone,c=i.verifyLogo;e.form={focusAddrList:s,mobilePhone:d,verifyLogo:c,defaultAddr:a},e.villages=(s||[]).map(function(e){return{village:e.addrDetail}})})},getType:function(){var e=this;this.$ajax("getUserType").then(function(r){var a=r.data.userType;e.type=a})},onRead:function(e){var r=this;return c()(s.a.mark(function a(){var t;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return r.loading=!0,t={imgBase64:e.content,bizType:1},a.next=4,r.$ajax("upload",t).then(function(e){r.form.verifyLogo=e.data}).finally(function(){r.loading=!1});case 4:case"end":return a.stop()}},a,r)}))()},handleAreaSelect:function(e){var r=[],a=[];e.map(function(e){a.push(e.code),-1===r.indexOf(e.name)&&r.push(e.name)}),this.area=r.join("/"),this.areaCode={provinceId:a[0],cityId:a[1],areaId:a[2]},this.areaSelectShow=!1},handleAddOrRemoveVillage:function(e,r){if(0===r){if(this.villages.length>=3)return this.$dialog.alert({title:"提醒",message:"服务小区最多添加3个"}),!1;this.villages.push({village:""})}else this.villages.splice(r,1)},submit:function(){var e=this;return c()(s.a.mark(function r(){var a,t;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(e.form.focusAddrList=[],e.area?e.errors.area=null:e.errors.area="请填写",e.form.mobilePhone?e.errors.mobilePhone=null:e.errors.mobilePhone="请填写",e.form.mobilePhone&&(/^\d{11}$/.test(e.form.mobilePhone)?e.errors.mobilePhone=null:e.errors.mobilePhone="格式不正确"),e.defaultAddr?e.errors.defaultAddr=null:e.errors.defaultAddr="请填写",2===e.type&&(e.errors.villages.length=0,e.villages.map(function(r){r.village?r.errorMessage=null:r.errorMessage="请填写",e.errors.villages.push(r.errorMessage)})),a=[],n()(e.errors).map(function(r){var t=e.errors[r]&&e.errors[r].join("");t&&a.push(t)}),!a.length){r.next=10;break}return r.abrupt("return",!1);case 10:return e.form.defaultAddr=o()({},e.areaCode,{addrDetail:e.defaultAddr}),2===e.type&&e.villages.map(function(r){e.form.focusAddrList.push(o()({},e.areaCode,{addrId:"",addrDetail:r.village}))}),t={mobilePhone:e.form.mobilePhone,defaultAddr:e.form.defaultAddr},2===e.type&&(t.verifyLogo=e.form.verifyLogo,t.focusAddrList=e.form.focusAddrList),r.next=16,e.$ajax("addUserDetail",t);case 16:return r.next=18,e.$dialog.alert({message:"操作成功"});case 18:window.location.href="/";case 19:case"end":return r.stop()}},r,e)}))()}}},h={render:function(){var e=this,r=e.$createElement,a=e._self._c||r;return a("div",{attrs:{id:"register-recyler"}},[a("van-row",[a("van-col",{staticClass:"title",attrs:{span:"24"}},[e._v("请补充以下信息")])],1),e._v(" "),a("van-cell-group",{staticClass:"content"},[2===e.type?a("van-cell",{staticClass:"van-field van-cell photo",attrs:{title:"头像"}},[a("div",{staticStyle:{"text-align":"left"}},[e.form.verifyLogo?a("img",{attrs:{src:e.form.verifyLogo}}):e._e()]),e._v(" "),a("template",{slot:"right-icon"},[a("van-uploader",{attrs:{"after-read":e.onRead}},[a("van-icon",{attrs:{name:"photograph"}})],1)],1)],2):e._e(),e._v(" "),a("van-field",{attrs:{label:"所在地区",readonly:"",required:"",autosize:"",placeholder:"选择 省 / 市 / 区","error-message":e.errors.area},on:{focus:function(r){r.preventDefault(),e.areaSelectShow=!0}},model:{value:e.area,callback:function(r){e.area=r},expression:"area"}}),e._v(" "),1===e.type||2===e.type?a("van-field",{attrs:{label:"住址",required:"",placeholder:"请输入您的小区地址","error-message":e.errors.defaultAddr},model:{value:e.defaultAddr,callback:function(r){e.defaultAddr=r},expression:"defaultAddr"}}):e._e(),e._v(" "),e._l(e.villages,function(r,t){return 2===e.type?a("van-field",{key:t,attrs:{label:"服务小区",required:"",placeholder:"请输入小区详细地址","error-message":e.errors.villages[t]},on:{"click-icon":function(a){e.handleAddOrRemoveVillage(r,t)}},model:{value:r.village,callback:function(a){e.$set(r,"village",a)},expression:"item.village"}},[a("van-icon",0===t?{attrs:{slot:"icon",name:"add"},slot:"icon"}:{attrs:{slot:"icon",name:"delete"},slot:"icon"})],1):e._e()}),e._v(" "),a("van-field",{attrs:{label:"手机号",required:"",placeholder:"请输入手机号","error-message":e.errors.mobilePhone},model:{value:e.form.mobilePhone,callback:function(r){e.$set(e.form,"mobilePhone",r)},expression:"form.mobilePhone"}})],2),e._v(" "),a("van-row",[a("van-col",{attrs:{span:"24"}},[a("van-button",{attrs:{type:"primary",block:""},on:{click:e.submit}},[e._v("提交信息")])],1)],1),e._v(" "),a("van-popup",{attrs:{position:"bottom",overlay:!0},model:{value:e.areaSelectShow,callback:function(r){e.areaSelectShow=r},expression:"areaSelectShow"}},[a("van-area",{attrs:{"area-list":e.areaList},on:{confirm:e.handleAreaSelect,cancel:function(r){e.areaSelectShow=!1}}})],1),e._v(" "),e.loading?a("van-loading",{staticClass:"loading",attrs:{color:"white"}}):e._e()],1)},staticRenderFns:[]};var m=a("VU/8")(v,h,!1,function(e){a("SAy0")},"data-v-47eebcd4",null);r.default=m.exports}});
//# sourceMappingURL=9.b2be20bb2d4944832907.js.map