webpackJsonp([4],{"3Skk":function(e,r){},t1HA:function(e,r,a){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t=a("woOf"),s=a.n(t),o=a("fZjL"),n=a.n(o),l=a("Xxa5"),i=a.n(l),c=a("exGp"),m=a.n(c),v=a("TIfe"),u=a("Cmve"),f={watch:{sendSmsWaitTime:function(e){e||(this.canSendsms=!0,this.sendSmsWaitTime=10,clearInterval(this.timeId))}},data:function(){return{username:Object(v.a)("username"),form:{type:+this.$route.params.id,avatar:Object(v.a)("avatar"),area:"",villages:[],phone:"",sms:"",onwervillage:""},errors:{area:"",phone:"",villages:[],sms:"",onwervillage:""},areaList:u.a,areaSelectShow:!1,villages:[{village:""}],canSendsms:!0,sendSmsWaitTime:10,timeId:null}},methods:{onRead:function(e){var r=this;return m()(i.a.mark(function a(){return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:console.log(e),r.form.avatar=e.content;case 2:case"end":return a.stop()}},a,r)}))()},handleAreaSelect:function(e){var r=[];e.map(function(e){-1===r.indexOf(e.name)&&r.push(e.name)}),this.form.area=r.join("/"),this.areaSelectShow=!1},handleAddOrRemoveVillage:function(e,r){if(0===r){if(this.villages.length>=5)return this.$dialog.alert({title:"提醒",message:"服务小区最多添加5个"}),!1;this.villages.push({village:""})}else this.villages.splice(r,1)},goPreStep:function(){this.$router.go(-1)},sendsms:function(){var e=this;this.$dialog.alert({message:"发送成功"}),this.canSendsms=!1,this.timeId=setInterval(function(){e.sendSmsWaitTime--},1e3)},submit:function(){var e=this;if(this.form.area?this.errors.area=null:this.errors.area="请填写",/^\d{11}$/.test(this.form.phone)?this.errors.phone=null:this.errors.phone="格式不正确",this.form.phone?this.errors.phone=null:this.errors.phone="请填写",2===this.form.type){this.errors.villages.length=0,this.villages.map(function(r){r.village?r.errorMessage=null:r.errorMessage="请填写",e.errors.villages.push(r.errorMessage)}),this.form.sms?this.errors.sms=null:this.errors.sms="请填写";var r=!0;if(n()(this.errors).map(function(a){if(r=e.errors[a]&&e.errors[a].toString())return!1}),r)return!1;var a=s()({},this.form);a.villages=a.villages.join(","),console.log(a)}else if(1===this.form.type){this.form.onwervillage?this.errors.onwervillage=null:this.errors.onwervillage="请填写";var t=s()({},this.form);console.log(t)}}}},h={render:function(){var e=this,r=e.$createElement,a=e._self._c||r;return a("div",{attrs:{id:"register-recyler"}},[a("van-row",[a("van-col",{staticClass:"title",attrs:{span:"24"}},[e._v("请补充以下信息")])],1),e._v(" "),a("van-cell-group",{staticClass:"content"},[a("van-cell",{staticClass:"van-field photo",attrs:{title:"头像"}},[[a("div",{staticStyle:{"text-align":"left"}},[a("img",{attrs:{src:e.form.avatar}})])],e._v(" "),a("template",{slot:"right-icon"},[a("van-uploader",{attrs:{"after-read":e.onRead}},[a("van-icon",{attrs:{name:"photograph"}})],1)],1)],2),e._v(" "),a("van-field",{attrs:{label:"地区",required:"",placeholder:"选择 省 / 市 / 区","error-message":e.errors.area},on:{focus:function(r){e.areaSelectShow=!0}},model:{value:e.form.area,callback:function(r){e.$set(e.form,"area",r)},expression:"form.area"}}),e._v(" "),e._l(e.villages,function(r,t){return 2===e.form.type?a("van-field",{key:t,attrs:{label:"服务小区",required:"",placeholder:"请输入小区详细地址","error-message":r.errorMessage},on:{"click-icon":function(a){e.handleAddOrRemoveVillage(r,t)}},model:{value:r.village,callback:function(a){e.$set(r,"village",a)},expression:"item.village"}},[a("van-icon",0===t?{attrs:{slot:"icon",name:"add"},slot:"icon"}:{attrs:{slot:"icon",name:"delete"},slot:"icon"})],1):e._e()}),e._v(" "),1===e.form.type?a("van-field",{attrs:{label:"小区地址",required:"",placeholder:"请输入您的小区地址","error-message":e.errors.onwervillage},model:{value:e.form.onwervillage,callback:function(r){e.$set(e.form,"onwervillage",r)},expression:"form.onwervillage"}}):e._e(),e._v(" "),a("van-field",{attrs:{label:"手机号",required:"",placeholder:"请输入手机号","error-message":e.errors.phone},model:{value:e.form.phone,callback:function(r){e.$set(e.form,"phone",r)},expression:"form.phone"}}),e._v(" "),a("van-field",{attrs:{center:"",clearable:"",required:"",label:"短信验证码",placeholder:"请输入短信验证码","error-message":e.errors.sms},model:{value:e.form.sms,callback:function(r){e.$set(e.form,"sms",r)},expression:"form.sms"}},[e.canSendsms?a("van-button",{attrs:{slot:"button",size:"small",type:"primary"},on:{click:e.sendsms},slot:"button"},[e._v("发送验证码")]):a("van-button",{attrs:{slot:"button",size:"small",disabled:""},slot:"button"},[e._v(e._s(e.sendSmsWaitTime)+"s后重试")])],1)],2),e._v(" "),a("van-row",[a("van-col",{attrs:{span:"24"}},[a("van-button",{attrs:{type:"primary",block:""},on:{click:e.submit}},[e._v("提交信息")])],1)],1),e._v(" "),a("van-row",{staticStyle:{"margin-top":"20px"}},[a("van-col",{attrs:{span:"24"}},[a("van-button",{attrs:{type:"info",block:""},on:{click:e.goPreStep}},[e._v("返回上一步")])],1)],1),e._v(" "),a("van-popup",{attrs:{position:"bottom",overlay:!0},model:{value:e.areaSelectShow,callback:function(r){e.areaSelectShow=r},expression:"areaSelectShow"}},[a("van-area",{attrs:{"area-list":e.areaList,value:"110101"},on:{confirm:e.handleAreaSelect,cancel:function(r){e.areaSelectShow=!1}}})],1)],1)},staticRenderFns:[]};var d=a("VU/8")(f,h,!1,function(e){a("3Skk")},"data-v-a0a4be7a",null);r.default=d.exports}});
//# sourceMappingURL=4.57f64df705ba3f6f38ac.js.map