webpackJsonp([11],{"2Pli":function(e,o){},p0rv:function(e,o,r){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var a=r("fZjL"),t=r.n(a),l=r("Xxa5"),i=r.n(l),s=r("exGp"),n=r.n(s),d=r("woOf"),c=r.n(d),f=(r("8e4C"),r("Cmve")),u={data:function(){return{type:+this.$route.query.type,defaultAddrTxt:"",areaCode:{},area:"",loading:!1,form:{verifyLogo:"",focusAddrList:[],mobilePhone:"",defaultAddr:{complexId:"",doorInfo:""}},errors:{area:"",mobilePhone:"",focusAddrList:[],defaultAddrTxt:"",villages:[],doorInfo:""},areaList:f.a,areaSelectShow:!1,villages:[{village:""}],searchDialog:{show:!1,provinceId:"",cityId:"",areaId:""}}},created:function(){this.getType(),this.getRecylerInfo()},methods:{getRecylerInfo:function(){var e=this;this.$ajax("getRecylerInfo").then(function(o){var r=o.data.defaultAddr||{};r.complexVo||(r.complexVo={}),o.data.focusAddrList||(o.data.focusAddrList=[]);var a=o.data,t=a.focusAddrList,l=a.mobilePhone,i=a.verifyLogo;e.form=c()({},e.form,{focusAddrList:t,mobilePhone:l,verifyLogo:i,defaultAddr:r}),e.defaultAddrTxt=r.complexVo.addrDetail?r.complexVo.addrDetail+r.doorInfo:"",t&&t.length&&(e.villages=t.map(function(e){return{village:e.complexVo.addrDetail+e.complexVo.complexName,complexVo:e.complexVo}}))})},getType:function(){var e=this;this.$ajax("getUserType").then(function(o){var r=o.data.userType;e.type=r})},onRead:function(e){var o=this;return n()(i.a.mark(function r(){var a;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return o.loading=!0,a={imgBase64:e.content,bizType:1},r.next=4,o.$ajax("upload",a).then(function(e){o.form.verifyLogo=e.data}).finally(function(){o.loading=!1});case 4:case"end":return r.stop()}},r,o)}))()},handleAddOrRemoveVillage:function(e,o){if(0===o){if(this.villages.length>=3)return this.$dialog.alert({title:"提醒",message:"服务小区最多添加3个"}),!1;this.villages.push({})}else this.villages.splice(o,1)},submit:function(){var e=this;return n()(i.a.mark(function o(){var r,a,l;return i.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(e.form.mobilePhone?e.errors.mobilePhone=null:e.errors.mobilePhone="请填写",e.form.mobilePhone&&(/^\d{11}$/.test(e.form.mobilePhone)?e.errors.mobilePhone=null:e.errors.mobilePhone="格式不正确"),e.defaultAddrTxt?e.errors.defaultAddrTxt=null:e.errors.defaultAddrTxt="请填写",e.form.defaultAddr.doorInfo?e.errors.doorInfo=null:e.errors.doorInfo="请填写",2===e.type&&(e.errors.villages.length=0,e.villages.map(function(o){o.village?o.errorMessage=null:o.errorMessage="请填写",e.errors.villages.push(o.errorMessage)})),r=[],t()(e.errors).map(function(o){var a=e.errors[o]&&e.errors[o].join("");a&&r.push(a)}),!r.length){o.next=9;break}return o.abrupt("return",!1);case 9:return a={mobilePhone:e.form.mobilePhone,defaultAddr:{doorInfo:e.form.defaultAddr.doorInfo,complexId:e.form.defaultAddr.complexId}},2===e.type&&(a.verifyLogo=e.form.verifyLogo,l=[],e.form.focusAddrList.map(function(e){l.push({complexId:e.complexId})}),a.focusAddrList=l),o.next=13,e.$ajax("addUserDetail",a);case 13:return o.next=15,e.$dialog.alert({message:"操作成功"});case 15:window.location.href="/";case 16:case"end":return o.stop()}},o,e)}))()},clickDefaultAddrHandle:function(){this.searchDialog=c()({},{show:!1},this.form.defaultAddr.complexVo||{}),this.searchDialog.show=!0,this.searchDialog.type="default"},clickFocusAddrHandle:function(e,o){var r=e.complexVo||{};this.searchDialog=c()({},{show:!1},r),this.searchDialog.type="focus",this.searchDialog.index=o,this.searchDialog.show=!0},searchHandle:function(e){if("default"===this.searchDialog.type)this.form.defaultAddr=c()({},this.form.defaultAddr,{complexVo:e,complexId:e.id}),this.defaultAddrTxt=e.addrDetail+e.complexName;else if("focus"===this.searchDialog.type){var o=this.searchDialog.index;this.villages[o]={village:e.addrDetail+e.complexName,complexVo:e},this.form.focusAddrList[o]={complexId:e.id}}}}},h={render:function(){var e=this,o=e.$createElement,r=e._self._c||o;return r("div",{attrs:{id:"register-recyler"}},[r("van-row",[r("van-col",{staticClass:"title",attrs:{span:"24"}},[e._v("请补充以下信息")])],1),e._v(" "),r("van-cell-group",{staticClass:"content"},[2===e.type?r("van-cell",{staticClass:"van-field van-cell photo",attrs:{title:"头像"}},[r("div",{staticStyle:{"text-align":"left"}},[e.form.verifyLogo?r("img",{attrs:{src:e.form.verifyLogo}}):e._e()]),e._v(" "),r("template",{slot:"right-icon"},[r("van-uploader",{attrs:{"after-read":e.onRead}},[r("van-icon",{attrs:{name:"photograph"}})],1)],1)],2):e._e(),e._v(" "),1===e.type||2===e.type?r("van-field",{attrs:{label:"住址",required:"",readonly:"",rows:"1",type:"textarea",autosize:"",placeholder:"请输入您的小区地址","error-message":e.errors.defaultAddrTxt},on:{focus:function(o){return o.preventDefault(),e.clickDefaultAddrHandle(o)}},model:{value:e.defaultAddrTxt,callback:function(o){e.defaultAddrTxt=o},expression:"defaultAddrTxt"}}):e._e(),e._v(" "),1===e.type||2===e.type?r("van-field",{attrs:{label:"门牌号",required:"",rows:"1",type:"textarea",autosize:"",placeholder:"请输入您的小区门牌号","error-message":e.errors.doorInfo},model:{value:e.form.defaultAddr.doorInfo,callback:function(o){e.$set(e.form.defaultAddr,"doorInfo",o)},expression:"form.defaultAddr.doorInfo"}}):e._e(),e._v(" "),e._l(e.villages,function(o,a){return 2===e.type?r("van-field",{key:a,attrs:{label:"服务小区",required:"",rows:"1",type:"textarea",autosize:"",placeholder:"请输入小区详细地址","error-message":e.errors.villages[a]},on:{"click-icon":function(r){e.handleAddOrRemoveVillage(o,a)},focus:function(r){r.preventDefault(),e.clickFocusAddrHandle(o,a)}},model:{value:o.village,callback:function(r){e.$set(o,"village",r)},expression:"item.village"}},[r("van-icon",0===a?{attrs:{slot:"icon",name:"add"},slot:"icon"}:{attrs:{slot:"icon",name:"delete"},slot:"icon"})],1):e._e()}),e._v(" "),r("van-field",{attrs:{label:"手机号",required:"",placeholder:"请输入手机号","error-message":e.errors.mobilePhone},model:{value:e.form.mobilePhone,callback:function(o){e.$set(e.form,"mobilePhone",o)},expression:"form.mobilePhone"}})],2),e._v(" "),r("van-row",[r("van-col",{attrs:{span:"24"}},[r("van-button",{attrs:{type:"primary",block:""},on:{click:e.submit}},[e._v("提交信息")])],1)],1),e._v(" "),e.loading?r("van-loading",{staticClass:"loading",attrs:{color:"white"}}):e._e(),e._v(" "),r("search",{attrs:{show:e.searchDialog.show,"province-id":e.searchDialog.provinceId,"city-id":e.searchDialog.cityId,"area-id":e.searchDialog.areaId},on:{"update:show":function(o){e.$set(e.searchDialog,"show",o)},select:e.searchHandle}})],1)},staticRenderFns:[]};var m=r("VU/8")(u,h,!1,function(e){r("2Pli")},"data-v-1fd2f665",null);o.default=m.exports}});
//# sourceMappingURL=11.ed0be8e4b234d0de7e92.js.map