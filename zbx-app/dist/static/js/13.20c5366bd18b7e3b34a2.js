webpackJsonp([13],{p0rv:function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var a=t("fZjL"),r=t.n(a),l=t("Xxa5"),i=t.n(l),n=t("exGp"),s=t.n(n),d=t("woOf"),c=t.n(d),f=t("8e4C"),u=t("Cmve"),h={data:function(){return{type:+this.$route.query.type,defaultAddrTxt:"",areaCode:{},area:"",loading:!1,form:{verifyLogo:"",focusAddrList:[],mobilePhone:"",defaultAddr:{complexId:"",doorInfo:""},voiceNotifyFlag:0,wxNotifyFlag:1},errors:{mobilePhone:"",focusAddrList:[],defaultAddrTxt:"",villages:[],doorInfo:""},areaList:u.a,areaSelectShow:!1,villages:[{village:""}],searchDialog:{show:!1,provinceId:"",cityId:"",areaId:""},voiceNotifyFlags:f.j,voiceNotifyFlagPopShow:!1,wxNotifyFlags:f.j,wxNotifyFlagPopShow:!1}},created:function(){this.getType(),this.getRecylerInfo()},methods:{getRecylerInfo:function(){var e=this;this.$ajax("getRecylerInfo").then(function(o){var t=o.data.defaultAddr||{};t.complexVo||(t.complexVo={}),o.data.focusAddrList||(o.data.focusAddrList=[]);var a=o.data,r=a.focusAddrList,l=a.mobilePhone,i=a.verifyLogo,n=a.wxNotifyFlag,s=a.voiceNotifyFlag;n||(n=0),s||(s=0),e.form=c()({},e.form,{focusAddrList:r,mobilePhone:l,verifyLogo:i,defaultAddr:t,wxNotifyFlag:n,voiceNotifyFlag:s}),e.defaultAddrTxt=t.complexVo.addrDetail?t.complexVo.addrDetail+t.doorInfo:"",r&&r.length&&(e.villages=r.map(function(e){return{village:e.complexVo.addrDetail+e.complexVo.complexName,complexVo:e.complexVo}}))})},getType:function(){var e=this;this.$ajax("getUserType").then(function(o){var t=o.data.userType;e.type=t})},onRead:function(e){var o=this;return s()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o.loading=!0,a={imgBase64:e.content,bizType:1},t.next=4,o.$ajax("upload",a).then(function(e){o.form.verifyLogo=e.data}).finally(function(){o.loading=!1});case 4:case"end":return t.stop()}},t,o)}))()},handleAddOrRemoveVillage:function(e,o){if(0===o){if(this.villages.length>=3)return this.$dialog.alert({title:"提醒",message:"服务小区最多添加3个"}),!1;this.villages.push({})}else this.villages.splice(o,1)},submit:function(){var e=this;return s()(i.a.mark(function o(){var t,a,l;return i.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(e.form.mobilePhone?e.errors.mobilePhone=null:e.errors.mobilePhone="请填写",e.form.mobilePhone&&(/^\d{11}$/.test(e.form.mobilePhone)?e.errors.mobilePhone=null:e.errors.mobilePhone="格式不正确"),e.defaultAddrTxt?e.errors.defaultAddrTxt=null:e.errors.defaultAddrTxt="请填写",e.form.defaultAddr.doorInfo?e.errors.doorInfo=null:e.errors.doorInfo="请填写",2===e.type&&(e.errors.villages.length=0,e.villages.map(function(o){o.village?o.errorMessage=null:o.errorMessage="请填写",e.errors.villages.push(o.errorMessage)})),t=[],r()(e.errors).map(function(o){var a=e.errors[o]&&e.errors[o]instanceof Array&&e.errors[o].join("");a&&t.push(a)}),!t.length){o.next=9;break}return o.abrupt("return",!1);case 9:return a={mobilePhone:e.form.mobilePhone,defaultAddr:{doorInfo:e.form.defaultAddr.doorInfo,complexId:e.form.defaultAddr.complexId}},2===e.type&&(a.verifyLogo=e.form.verifyLogo,l=[],e.form.focusAddrList.map(function(e){l.push({complexId:e.complexId})}),a.focusAddrList=l,a.voiceNotifyFlag=e.form.voiceNotifyFlag,a.wxNotifyFlag=e.form.wxNotifyFlag),o.next=13,e.$ajax("addUserDetail",a);case 13:return o.next=15,e.$dialog.alert({message:"操作成功"});case 15:window.location.href="/";case 16:case"end":return o.stop()}},o,e)}))()},clickDefaultAddrHandle:function(){this.searchDialog=c()({},{show:!1},this.form.defaultAddr.complexVo||{}),this.searchDialog.show=!0,this.searchDialog.type="default"},clickFocusAddrHandle:function(e,o){var t=e.complexVo||{};this.searchDialog=c()({},{show:!1},t),this.searchDialog.type="focus",this.searchDialog.index=o,this.searchDialog.show=!0},searchHandle:function(e){if("default"===this.searchDialog.type)this.form.defaultAddr=c()({},this.form.defaultAddr,{complexVo:e,complexId:e.id}),this.defaultAddrTxt=e.addrDetail+e.complexName;else if("focus"===this.searchDialog.type){var o=this.searchDialog.index;this.villages[o]={village:e.addrDetail+e.complexName,complexVo:e},this.form.focusAddrList[o]={complexId:e.id}}},formatVoiceNotifyFlag:function(e){var o=f.j.filter(function(o){return o.id===e});return o.length?o[0].label:"请选择"},handleVoiceNotifyFlagConfirm:function(e){this.form.voiceNotifyFlag=e[0].id,this.voiceNotifyFlagPopShow=!1},formatWxNotifyFlag:function(e){var o=f.j.filter(function(o){return o.id===e});return o.length?o[0].label:"请选择"},handleWxNotifyFlagConfirm:function(e){this.form.wxNotifyFlag=e[0].id,this.wxNotifyFlagPopShow=!1}}},v={render:function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",{attrs:{id:"register-recyler"}},[t("van-row",[t("van-col",{staticClass:"title",attrs:{span:"24"}},[e._v("请补充以下信息")])],1),e._v(" "),t("van-cell-group",{staticClass:"content"},[2===e.type?t("van-cell",{staticClass:"van-field van-cell photo",attrs:{title:"头像"}},[t("div",{staticStyle:{"text-align":"left"}},[e.form.verifyLogo?t("img",{attrs:{src:e.form.verifyLogo}}):e._e()]),e._v(" "),t("template",{slot:"right-icon"},[t("van-uploader",{attrs:{"after-read":e.onRead}},[t("van-icon",{attrs:{name:"photograph"}})],1)],1)],2):e._e(),e._v(" "),1===e.type?t("van-field",{attrs:{label:"住址",required:"",readonly:"",rows:"1",type:"textarea",autosize:"",placeholder:"请输入您的小区地址","error-message":e.errors.defaultAddrTxt},on:{focus:function(o){return o.preventDefault(),e.clickDefaultAddrHandle(o)}},model:{value:e.defaultAddrTxt,callback:function(o){e.defaultAddrTxt=o},expression:"defaultAddrTxt"}}):e._e(),e._v(" "),1===e.type?t("van-field",{attrs:{label:"门牌号",required:"",rows:"1",type:"textarea",autosize:"",placeholder:"请输入您的小区门牌号","error-message":e.errors.doorInfo},model:{value:e.form.defaultAddr.doorInfo,callback:function(o){e.$set(e.form.defaultAddr,"doorInfo",o)},expression:"form.defaultAddr.doorInfo"}}):e._e(),e._v(" "),e._l(e.villages,function(o,a){return 2===e.type?t("van-field",{key:a,staticClass:"blur",attrs:{label:"服务小区",required:"",readonly:"",rows:"1",type:"textarea",autosize:"",placeholder:"请输入小区详细地址","error-message":e.errors.villages[a]},on:{"click-icon":function(t){e.handleAddOrRemoveVillage(o,a)},focus:function(t){t.preventDefault(),e.clickFocusAddrHandle(o,a)}},model:{value:o.village,callback:function(t){e.$set(o,"village",t)},expression:"item.village"}},[t("van-icon",0===a?{attrs:{slot:"icon",name:"add"},slot:"icon"}:{attrs:{slot:"icon",name:"delete"},slot:"icon"})],1):e._e()}),e._v(" "),t("van-field",{staticClass:"blur",attrs:{label:"手机号",required:"",placeholder:"请输入手机号","error-message":e.errors.mobilePhone},model:{value:e.form.mobilePhone,callback:function(o){e.$set(e.form,"mobilePhone",o)},expression:"form.mobilePhone"}}),e._v(" "),2===e.type?t("van-cell",{attrs:{title:"电话通知订单",value:e.formatVoiceNotifyFlag(e.form.voiceNotifyFlag)},on:{click:function(o){e.voiceNotifyFlagPopShow=!0}}}):e._e(),e._v(" "),2===e.type?t("van-cell",{attrs:{title:"微信通知订单",value:e.formatWxNotifyFlag(e.form.wxNotifyFlag)},on:{click:function(o){e.wxNotifyFlagPopShow=!0}}}):e._e()],2),e._v(" "),t("van-row",[t("van-col",{attrs:{span:"24"}},[t("van-button",{attrs:{type:"primary",block:""},on:{click:e.submit}},[e._v("提交信息")])],1)],1),e._v(" "),e.loading?t("van-loading",{staticClass:"loading",attrs:{color:"white"}}):e._e(),e._v(" "),t("search",{attrs:{show:e.searchDialog.show,"province-id":e.searchDialog.provinceId,"city-id":e.searchDialog.cityId,"area-id":e.searchDialog.areaId},on:{"update:show":function(o){e.$set(e.searchDialog,"show",o)},select:e.searchHandle}}),e._v(" "),t("van-popup",{attrs:{position:"bottom"},model:{value:e.voiceNotifyFlagPopShow,callback:function(o){e.voiceNotifyFlagPopShow=o},expression:"voiceNotifyFlagPopShow"}},[t("van-picker",{attrs:{columns:[{values:e.voiceNotifyFlags,defaultIndex:e.form.voiceNotifyFlag?0:1}],"value-key":"label","show-toolbar":"",title:"电话通知订单"},on:{confirm:e.handleVoiceNotifyFlagConfirm,cancel:function(o){e.voiceNotifyFlagPopShow=!1}}})],1),e._v(" "),t("van-popup",{attrs:{position:"bottom"},model:{value:e.wxNotifyFlagPopShow,callback:function(o){e.wxNotifyFlagPopShow=o},expression:"wxNotifyFlagPopShow"}},[t("van-picker",{attrs:{columns:[{values:e.wxNotifyFlags,defaultIndex:e.form.wxNotifyFlag?0:1}],"value-key":"label","show-toolbar":"",title:"微信通知订单"},on:{confirm:e.handleWxNotifyFlagConfirm,cancel:function(o){e.wxNotifyFlagPopShow=!1}}})],1)],1)},staticRenderFns:[]};var g=t("VU/8")(h,v,!1,function(e){t("r/jN")},"data-v-0f614d40",null);o.default=g.exports},"r/jN":function(e,o){}});
//# sourceMappingURL=13.20c5366bd18b7e3b34a2.js.map